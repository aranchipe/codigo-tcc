<!DOCTYPE html>
<html>

<head>
    <title>Cálculo do diâmetro</title>
    <script>
        function verificarReynolds(event) {
            
            let q = parseFloat(document.getElementById("q").value) / 3600; // Convertendo para m³/s
            let d = parseFloat(document.getElementById("vel_eco").value); // Velocidade econômica
            let visc = parseFloat(document.getElementById("visc").value);
            
            let d_calc = Math.sqrt((4 * q) / (Math.PI * d)); // Cálculo do diâmetro
            let d_int = d_calc * 100; // Converter para cm
            let vel = q / ((Math.PI * (d_int / 100) ** 2) / 4) * 100; // Velocidade em cm/s
            
            /* let reynolds = (d_int * vel) / visc; */ // Cálculo do número de Reynolds
            let reynolds = 5000
            // Se Reynolds > 4000, exibe o campo do fator de atrito
            if (reynolds > 4000) {
                print("entrou reynolds")
                document.getElementById("f_input").style.display = "block";
                document.getElementById("reynolds_value").innerText = "Número de Reynolds: " + reynolds.toFixed(2) + " (Turbulento)";
            } else {
                document.getElementById("f_input").style.display = "none";
                document.getElementById("reynolds_value").innerText = "Número de Reynolds: " + reynolds.toFixed(2) + " (Laminar)";
            }

        }
    </script>
</head>

<body>
    <h1>Cálculo do diâmetro</h1>
    <h2>Tipo de tubulação selecionada: Recalque</h2>
    
    <form id="calcForm" action="/calculate" method="post" onsubmit="verificarReynolds(event)">
        <input type="hidden" name="tipoDeTubulacao" value="{{ tipo_tubulacao }}">

        <label for="q">Q (m^3/h):</label>
        <input type="text" name="q" id="q" required value="200"><br><br>

        <label for="l_equi">Comprimento equivalente (metros):</label>
        <input type="text" name="l_equi" id="l_equi" required value="215"><br><br>

        <label for="h1">H1 (metros):</label>
        <input type="text" name="h1" id="h1" required value="0.85"><br><br>

        <label for="h2">H2 (metros):</label>
        <input type="text" name="h2" id="h2" required value="13.70"><br><br>

        <label for="p1">P1 (kPa):</label>
        <input type="text" name="p1" id="p1" required value="316"><br><br>

        <label for="p2">P2 (kPa):</label>
        <input type="text" name="p2" id="p2" required value="155.8"><br><br>

        <label for="peso_esp">Peso Específico (N/dm³):</label>
        <input type="text" name="peso_esp" id="peso_esp" required value="9.5"><br><br>

        <label for="visc">Viscosidade (stokes):</label>
        <input type="text" name="visc" id="visc" required value="5.5"><br><br>

        <label for="vel_eco">Velocidade Econômica (m/s):</label>
        <input type="text" name="vel_eco" id="vel_eco" required value="1"><br><br>

        <!-- Resultado do número de Reynolds -->
        <p id="reynolds_value"></p>

        <!-- Campo do fator de atrito (oculto por padrão) -->
        <div id="f_input" style="display: none;">
            <label for="f">Fator de Atrito (f):</label>
            <input type="text" name="f" id="f"><br><br>
        </div>

        <input type="submit" value="Calcular">
        <button type="button" onclick="window.location.href='/espessura'">Calcular Espessura</button>
    </form>
</body>

</html>
